<h3>National Parks Around Your Area</h3>

<div id="map"></div>
<script>
  function initMap() {
    var yourLocation = {position: {lat: <%= @current_location[:lat] %> , lng: <%= @current_location[:long] %> }, info: 'Your Location'};

    var parks = [yourLocation]
    <% @parks.each do |park| %>
      parks.push({position: {lat: <%= park.latitude %>, lng: <%= park.longitude %>}, info: '<%= link_to park.full_name, park_path(park) %>'})
    <% end %>
    
    var map = new google.maps.Map(
      document.getElementById('map'), {zoom: 5, center: yourLocation.position});

    parks.forEach(park => {
      var marker = new google.maps.Marker({position: park.position, map: map});
      var infoWindow = new google.maps.InfoWindow({content: park.info});
      marker.addListener('click', function() {
        infoWindow.open(map, marker);
      });
    });
  }
  </script>

<script async defer
src="https://maps.googleapis.com/maps/api/js?<%= ENV['GOOG_GEO_KEY'] %>&callback=initMap">
</script>
